#pragma once

#include "helper.cuh"

__global__ void fillTablePsi128(unsigned long long psi, unsigned long long q, unsigned long long psiinv, unsigned long long psiTable[], unsigned long long psiinvTable[], unsigned int nbit)
{   
    int i = blockIdx.x * blockDim.x + threadIdx.x;
    psiTable[i] = modpow128(psi, bitReverse(i, nbit), q);
    psiinvTable[i] = modpow128(psiinv, bitReverse(i, nbit), q);
}

__global__ void fillTablePsi128Forward(unsigned long long psi, unsigned long long q, unsigned long long psiTable[], unsigned int nbit)
{
    int i = blockIdx.x * blockDim.x + threadIdx.x;
    psiTable[i] = modpow128(psi, bitReverse(i, nbit), q);
}

__global__ void fillTablePsi64(unsigned psi, unsigned q, unsigned psiinv, unsigned psiTable[], unsigned psiinvTable[], unsigned int nbit)
{
    int i = blockIdx.x * blockDim.x + threadIdx.x;
    psiTable[i] = modpow64(psi, bitReverse(i, nbit), q);
    psiinvTable[i] = modpow64(psiinv, bitReverse(i, nbit), q);
}
__global__ void fillTablePsi128Rot(unsigned long long q, unsigned long long psiTable[],unsigned long long psiRotTable[])
{
    int i = blockIdx.x * blockDim.x + threadIdx.x;
    psiRotTable[i] = modpow128(psiTable[i], 3, q);
    
}



void getPs(unsigned long long* Ps,int size){
    if (size == 4){
        unsigned long long Ps_t[4] = {606734731968862, 341977924239645, 1078577548624021, 34074287996961};
        for(int i = 0; i < 4; i++){
            Ps[i] = Ps_t[i];
        }
    }
    else if (size == 8){
        unsigned long long Ps_t[8] = {1003328890238145, 317976137882879, 192529089797866, 186364601662971, 1009618245987916, 727831952145891, 534429747936998, 625872368560640};
        for(int i = 0; i < 8; i++){
            Ps[i] = Ps_t[i];
        }
    }else if (size == 16) {
        unsigned long long Ps_t[16] = {72931018067010, 372261500327214, 59695793408369, 613778562678081, 832345003539559, 825051505769415, 245780070530964, 1007346897386693, 168301617510047, 1071875930769456, 274426509838971, 776699555533463, 207759084784481, 162299309738299, 777513180050365, 1020349149053124};
        for(int i = 0; i < 16; i++){
            Ps[i] = Ps_t[i];
        }
    }else if (size == 32) {
        unsigned long long Ps_t[32] = {679700219, 83975396, 890524236, 437952193, 820531933, 420438247, 443674975, 377863261, 136406322, 172336870, 103925860, 911157924, 517788511, 723425186, 709247663, 132021506, 905869496, 1049187777, 1040055446, 306812279, 895415336, 1067994416, 575882670, 999502192, 658419250, 861822316, 461163857, 298412841, 773600325, 755340512, 783915252, 149252917};
        for(int i = 0; i < 32; i++){
            Ps[i] = Ps_t[i];
        }          
    }
}
void getrnsPrime(unsigned long long* temp, unsigned long long* B_basis,unsigned long long* qi_qj_inv,int modulenum){
    if (modulenum == 4) {
unsigned long long q_t[ 8 ] ={ 1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337 };
unsigned long long qi_qj_inv_t[ 16 ] ={ 1125899908022273, 500401868257511, 696986476288100, 193011904050441, 625498040026907, 1125899908612097, 93826424105646, 995989042966846, 428913432586142, 1032073484571988, 1125899909398529, 1045479715284119, 932888004365049, 129910867152580, 80420194966379, 1125899910316033 };

        for(int i = 0; i < 4; i++){
            temp[i] = q_t[i];
            B_basis[i] = q_t[i+4];
        }
        for(int i = 0; i < 16; i++){
            qi_qj_inv[i] = qi_qj_inv_t[i];
        }
    }
    else if (modulenum == 8) {
        unsigned long long q_t[16] = {1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337, 1125899915100161, 1125899915231233, 1125899915886593, 1125899917262849, 1125899918180353, 1125899919360001, 1125899920539649, 1125899921391617};
        unsigned long long qi_qj_inv_t[ 64 ] ={ 1125899908022273, 500401868257511, 696986476288100, 193011904050441, 1078987772783277, 419453245015624, 455721598092826, 761972842950120, 625498040026907, 1125899908612097, 93826424105646, 995989042966846, 288692725424340, 991864616675233, 555444186405057, 838170127245132, 428913432586142, 1032073484571988, 1125899909398529, 1045479715284119, 792300573780047, 487890534253639, 982928768632867, 534080948932715, 932888004365049, 129910867152580, 80420194966379, 1125899910316033, 866078176273020, 774057262804997, 137865646143532, 193514316241922, 46912138253653, 837207183843118, 333599336863667, 259821734698374, 1125899911168001, 375305697077954, 312750453198396, 485682652923465, 706446664251834, 134035294361697, 638009375996859, 351842648231933, 750594214155584, 1125899911364609, 443536850173459, 1008619031329454, 670178312157672, 570455724631873, 142971144370143, 988034264565718, 813149458624966, 682363062043119, 1125899913527297, 525421105429444, 363927069463066, 287729785757878, 591818962890647, 932385594795008, 640217259686329, 117280882853204, 600478808556606, 1125899914510337 };
        for(int i = 0; i < 8; i++){
            temp[i] = q_t[i];
            B_basis[i] = q_t[i+8];
        }   
        for(int i = 0; i < 64; i++){
            qi_qj_inv[i] = qi_qj_inv_t[i];
        }     
    }else if (modulenum == 16) {
unsigned long long q_t[ 32 ] ={ 1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337, 1125899915100161, 1125899915231233, 1125899915886593, 1125899917262849, 1125899918180353, 1125899919360001, 1125899920539649, 1125899921391617, 1125899922702337, 1125899924275201, 1125899926110209, 1125899927027713, 1125899927224321, 1125899928272897, 1125899928403969, 1125899929190401, 1125899930632193, 1125899930959873, 1125899931811841, 1125899935285249, 1125899935547393, 1125899935875073, 1125899935940609, 1125899936071681 };
    unsigned long long qi_qj_inv_t[ 256 ] ={ 1125899908022273, 500401868257511, 696986476288100, 193011904050441, 1078987772783277, 419453245015624, 455721598092826, 761972842950120, 604650113478506, 573185567571076, 431595110922105, 439180940633518, 479415559869501, 748430681539130, 330106872932407, 386338292535699, 625498040026907, 1125899908612097, 93826424105646, 995989042966846, 288692725424340, 991864616675233, 555444186405057, 838170127245132, 45491079194646, 468196174451298, 588308218930556, 315593288777233, 454987070907604, 528623847381643, 142284150287260, 733278498444127, 428913432586142, 1032073484571988, 1125899909398529, 1045479715284119, 792300573780047, 487890534253639, 982928768632867, 534080948932715, 867072545880231, 177108044866366, 625500126804363, 684922592833811, 663776945642666, 66665239829667, 748392401181469, 762904958647158, 932888004365049, 129910867152580, 80420194966379, 1125899910316033, 866078176273020, 774057262804997, 137865646143532, 193514316241922, 262196105980439, 540432188375916, 278163710746915, 711653883363021, 478507608392228, 513997913764851, 541298148848353, 586267516345158, 46912138253653, 837207183843118, 333599336863667, 259821734698374, 1125899911168001, 375305697077954, 312750453198396, 485682652923465, 187650272181182, 1089580840221666, 719325184870175, 1101687200546114, 925973925044303, 137438955, 283443456778299, 72173182011446, 706446664251834, 134035294361697, 638009375996859, 351842648231933, 750594214155584, 1125899911364609, 443536850173459, 1008619031329454, 79010821759122, 228996884112612, 946408873931764, 537930151357465, 32478047446254, 9228828682208, 184969395373438, 515117723380932, 670178312157672, 570455724631873, 142971144370143, 988034264565718, 813149458624966, 682363062043119, 1125899913527297, 525421105429444, 469125680452955, 346431403912276, 312750453853757, 316042383439911, 301297403173184, 88554119274038, 683958056214454, 769365089449850, 363927069463066, 287729785757878, 591818962890647, 932385594795008, 640217259686329, 117280882853204, 600478808556606, 1125899914510337, 500401871141106, 102356099554595, 375300790051213, 187650395254983, 703687755646102, 106504278586343, 36714314581395, 75060158377245, 521249798344856, 1080408829679596, 258827367909211, 863703805449707, 938249639642180, 1046889089867632, 656774233729703, 625498043631376, 1125899915100161, 8589934656, 938251361561271, 136473237846083, 766570522588099, 433038694828760, 1112335068242417, 398756401116504, 552714344121214, 657703736913312, 948791865449668, 585467724299414, 36319074878496, 896903028038430, 779468510139310, 1023543815021279, 1125891325165506, 1125899915231233, 675541667518888, 1053261767112644, 900720316319157, 965057346433483, 212097153, 1054034151726933, 694304800114825, 537591693482630, 500399786198647, 847736200945375, 406574729312483, 179491041233934, 813149460328901, 750599124917877, 187648554194251, 450358248105562, 1125899915886593, 375300790509966, 675540441761622, 382381428836781, 586736820279386, 938250139015269, 686718970993236, 810306622259697, 440977321348847, 414246031343925, 24212716585664, 587969762825193, 809857531135963, 938249519714107, 989426677516223, 72638150019134, 750599125835380, 1125899917262849, 562951186223702, 35184909350918, 968274275261486, 125100263962075, 646484352478149, 670912841571118, 462122968933208, 647392305266142, 199925991890867, 1093421864114964, 824602511599298, 422212161157996, 359329394609215, 225179601271373, 450359475501228, 562948731497900, 1125899918180353, 562950914117188, 844425417623331, 321686042435756, 377469234019784, 597276066276727, 1059234670158687, 611902000679951, 1125899773729047, 1116671082747938, 1037345794712012, 1019395636382747, 692861221909802, 160842572336695, 743518488229461, 1090715007977468, 562949004652990, 1125899919360001, 562950914707013, 217916668007068, 795793038759883, 983615759832166, 377507515622629, 584601766382881, 842456456748999, 940930517498500, 441941861572684, 1089185600125551, 13564852231697, 1125899703134081, 539163098032040, 157625644819412, 281474502326495, 562949005242813, 1125899920539649, 866078184137352, 739561620074095, 392621418491043, 362994958877836, 539632399738044, 1053726729811916, 610782192571198, 356534829451400, 1050839756591845, 727143516211882, 71865769271469, 187649781458845, 1000799653759527, 804213876662102, 907983251746150, 259821737057658, 1125899921391617 };
        for(int i = 0; i < 16; i++){
            temp[i] = q_t[i];
            B_basis[i] = q_t[i+16];
        }   
        for(int i = 0; i < 256; i++){
            qi_qj_inv[i] = qi_qj_inv_t[i];
        } 
    }else if (modulenum == 32) {
        unsigned long long q_t[ 64 ] ={ 1073872897, 1074266113, 1077477377, 1079443457, 1080360961, 1081212929, 1082982401, 1083703297, 1085276161, 1086128129, 1086259201, 1086455809, 1086914561, 1087635457, 1088094209, 1088684033, 1089208321, 1089601537, 1090977793, 1091043329, 1091174401, 1092616193, 1093533697, 1093599233, 1093795841, 1093926913, 1094516737, 1094582273, 1094909953, 1095172097, 1095565313, 1095761921, 1096089601, 1098842113, 1099104257, 1099431937, 1100021761, 1100808193, 1100873729, 1101070337, 1102053377, 1103626241, 1105002497, 1107296257, 1108738049, 1108934657, 1109065729, 1110048769, 1111031809, 1111883777, 1112473601, 1113980929, 1115815937, 1116143617, 1116209153, 1117126657, 1118568449, 1120075777, 1120337921, 1121058817, 1121124353, 1122500609, 1122697217, 1123418113 };
unsigned long long qi_qj_inv_t[ 1024 ] ={ 1073872897, 2732, 822801205, 406378907, 818455440, 598528733, 1059608799, 86696374, 785889729, 1074511874, 1000048241, 712986711, 699121007, 683656652, 451283389, 183053141, 55856908, 1007881491, 163019734, 124928689, 719183191, 244501584, 590508252, 47231916, 856327062, 235945075, 823493598, 62349676, 511640217, 40437175, 824156434, 990778793, 1073870166, 1074266113, 241883012, 150302462, 104551238, 591607230, 146569171, 180617331, 930236808, 318037610, 89037730, 595798436, 433639574, 575807088, 603350896, 475062199, 630594364, 27938572, 25670131, 1056948290, 279137702, 998963436, 223170199, 541238999, 954318575, 787627433, 967000278, 797985840, 646518311, 933814505, 896678123, 53451852, 253824205, 833103998, 1077477377, 251870689, 761163779, 531122430, 863807588, 536148121, 355678881, 255075671, 883599026, 745451552, 777445947, 961329511, 208215661, 541158827, 638921175, 954137652, 121808281, 685196374, 46988451, 614892302, 923924457, 911332762, 149353716, 688607446, 282048608, 960380679, 506293011, 1001879721, 789918529, 51057067, 669591143, 924684548, 826065441, 1079443457, 540181658, 400449844, 742043803, 866962892, 646288237, 521767597, 678912160, 903687697, 581594779, 626478156, 898502162, 308846652, 643290932, 224950102, 948406926, 468470676, 146302806, 250051550, 849396019, 734129192, 769153316, 579137853, 128486820, 829229067, 78870703, 990218174, 485433479, 44006570, 260332658, 970304700, 318345215, 539720552, 1080360961, 249511945, 947610014, 63747577, 217055453, 925677571, 905216185, 105141063, 163037350, 411537890, 285855399, 668640718, 605115857, 440477335, 141423150, 1050882327, 495988465, 116857436, 881355600, 600938275, 827016449, 776846729, 380040611, 670873083, 754600178, 373133930, 656394807, 46628238, 479407397, 486459972, 548189956, 679648974, 831045625, 1081212929, 401105205, 798518654, 910231886, 188262430, 874650481, 1059294621, 1061928210, 377343083, 134716584, 267396224, 1053496709, 119175298, 51254102, 640078864, 1019386721, 1080057482, 244300170, 682776329, 808953261, 1082649402, 145576200, 826302386, 843447460, 622140096, 365188514, 375125778, 23176995, 928876591, 218060702, 339824487, 135044708, 680763085, 1082982401, 492593911, 775197731, 429926063, 543129932, 20499479, 996338624, 15319043, 850945684, 763330375, 859901481, 140245907, 903186670, 913638045, 872939654, 497995249, 1025612453, 614305845, 762342657, 235816680, 715167281, 6184175, 992638236, 253185037, 656198061, 561929276, 987962956, 895221647, 544409449, 215888438, 1016809993, 284529284, 590716171, 1083703297, 690, 205484148, 425, 931248231, 177455777, 217527368, 259843641, 401094336, 466803764, 508480902, 796119080, 77931815, 631732694, 706987071, 87482807, 680783739, 1051180527, 107, 179102840, 540697368, 787566906, 1013816551, 847398677, 666985608, 296240705, 153466490, 724354401, 436628629, 864288549, 174388916, 309423071, 1083702608, 1085276161, 835484451, 1105, 921, 652149400, 461, 253045551, 753704650, 277, 594328363, 489059202, 991857761, 185, 312176204, 156219232, 792213749, 84138270, 298343830, 1024654085, 323749804, 916149258, 217583971, 286103150, 547881065, 11485184, 759701912, 824433323, 560887125, 159598591, 893802468, 654301523, 878677902, 250447071, 1086128129, 543137888, 651876801, 634034876, 520174201, 471508044, 279150178, 69524289, 1027926292, 103200827, 189114399, 1062832425, 1070543307, 938697215, 930518792, 822684194, 1075541727, 572911235, 797602716, 433061524, 817411179, 874930748, 924316292, 85227921, 986211424, 201021776, 404791138, 180059977, 210625681, 541490870, 1083702873, 1085275057, 543055778, 1086259201, 5526, 543458939, 310753778, 505187190, 676749983, 726139250, 326, 863690984, 1061151959, 222, 585732564, 591099446, 947135199, 618232577, 364642447, 964217258, 232706599, 970488494, 136896635, 285464319, 944622461, 369143723, 485152350, 338186210, 181588465, 975809723, 27030117, 1062548459, 154814363, 1085275241, 434447937, 1086253676, 1086455809, 155275878, 922, 348190811, 384241912, 933607528, 681001307, 948676583, 124690904, 818381032, 348707473, 546767003, 431420034, 761750824, 806051556, 347042028, 900382327, 76389196, 65875139, 63054239, 540164445, 383140499, 645672812, 306781639, 501846375, 918306652, 24855280, 90248258, 906771809, 434109802, 452552006, 543127943, 931245468, 1086914561, 197753410, 785846740, 887076494, 466804041, 53151700, 545489165, 380999522, 839365180, 1067498771, 768721873, 139380458, 885453935, 156, 254758350, 711010850, 421809709, 738806706, 655679367, 1055178270, 398866998, 505536914, 125126299, 457683894, 671575584, 706098071, 1067728895, 866962362, 1085275701, 566674825, 775898640, 1086454888, 889292224, 1087635457, 932654551, 816514063, 544604853, 435841169, 128350655, 167853140, 727449909, 632567489, 874827143, 408597699, 930890255, 136741038, 281447320, 41305149, 414290403, 542824576, 217302349, 388818881, 628487749, 478582930, 871293333, 188084720, 796537179, 947348314, 236034414, 824908233, 832885971, 615472054, 581923980, 738789287, 301919790, 155374123, 1088094209, 483861416, 576640677, 1042228280, 520694325, 315190665, 742927606, 348370622, 184451668, 169247699, 917782909, 946431337, 301550700, 840285550, 642206960, 861941157, 297917030, 206040846, 893310125, 605495371, 541889111, 773218246, 416832052, 815651714, 323649723, 684443970, 333930808, 807633312, 411016547, 703000330, 201279860, 271907827, 604494938, 1088684033, 544606238, 155658550, 498733181, 121227499, 804023681, 291364596, 886649169, 889460932, 140230450, 1039230776, 971537516, 924314105, 760674459, 940299444, 166943445, 771091877, 1018802422, 452322502, 445437483, 441919694, 480160305, 35449469, 227996121, 619258830, 1085275885, 1016800449, 362086032, 155207578, 621093561, 543817037, 512043357, 544339940, 1089208321, 2771, 848538900, 311727260, 555, 252142519, 795297487, 1011987599, 781282982, 182321384, 648602717, 320365747, 302044317, 770231109, 1016504071, 876609704, 80540399, 1046720758, 133956558, 856590508, 643619179, 962955136, 943588463, 577974908, 493307095, 61478638, 1086258876, 407420583, 1033893934, 652580721, 47307722, 933156556, 1089205551, 1089601537, 467562704, 694301057, 272794294, 522555933, 765473866, 1057743794, 239268101, 596687660, 394026248, 316852983, 567731293, 219034616, 698272581, 116570595, 913409068, 1048989199, 957176425, 141063540, 940314068, 1030417580, 186414868, 292892634, 598772864, 983386055, 226303770, 141711387, 543457013, 959678019, 568776141, 590999429, 242045678, 622628658, 1090977793, 16648, 5550, 917798269, 504708288, 27340398, 737676653, 510499597, 425645707, 417931717, 383218762, 975387910, 798197824, 600417720, 950910289, 33570752, 400800684, 615953518, 39767787, 446901234, 176094565, 1006295771, 98661281, 897865699, 29760299, 962289194, 707356832, 920306606, 773755513, 967718679, 778005350, 396217985, 1090961146, 1091043329, 8325, 728411490, 1035979731, 953394631, 572941076, 895031490, 206512907, 810801993, 315482812, 382441315, 968543490, 608756855, 366092971, 799453788, 1031078751, 934713516, 589287697, 71132321, 216596348, 456295980, 1085275977, 28210905, 1086258980, 271613722, 250826182, 362544845, 347263756, 286495361, 1089207767, 817200460, 1090972244, 1091035005, 1091174401, 993288206, 546767312, 451, 820347298, 312550944, 1030133727, 1052483276, 172880812, 807914116, 637717372, 626149908, 833565618, 92079894, 471104756, 832406564, 964814246, 12427640, 589378065, 382483395, 775197110, 21941815, 503934510, 739714417, 24986351, 457951553, 741165380, 798368014, 837852235, 568487397, 174555781, 363680416, 99196916, 1092616193, 312439391, 72907728, 972263897, 875142365, 1019033400, 583777769, 344115034, 702033824, 389534705, 365254322, 493981478, 855028075, 167118873, 240991951, 209622194, 839665272, 67265885, 997006923, 930236578, 153787907, 499091916, 543227751, 322845745, 217526907, 904560046, 205967025, 297056563, 326880184, 587449154, 57422895, 545586738, 780438947, 1093533697, 16687, 546902093, 2782, 875614503, 136823828, 938495041, 525683275, 176704622, 902392662, 1027492950, 542595371, 179579496, 354816986, 486697183, 406169849, 474640333, 409079943, 299091725, 161966330, 145480995, 657853824, 948386072, 681265983, 919698479, 203220798, 81283955, 35724368, 1063702932, 139876923, 1091173951, 1019774002, 1093517011, 1093599233, 364604177, 218788721, 1016338163, 72973265, 54746333, 45632867, 36519401, 730508454, 233143404, 136986899, 930351886, 320382686, 263502593, 281565781, 328176385, 42222099, 1001793252, 269211104, 472286465, 329816794, 207031187, 161988083, 175095429, 949108944, 311202140, 851250941, 355201685, 519544046, 272793184, 121400873, 546762677, 729060593, 1093795841, 8346, 497509126, 912153286, 644065661, 52151848, 1014412946, 365254531, 842253199, 300794457, 399224620, 507973317, 313148025, 11146440, 849525018, 1083703191, 789291628, 18254115, 724172659, 285909278, 1086914406, 951680852, 146709145, 54433994, 907673370, 495273174, 581854453, 198371136, 779409890, 218522405, 1093530916, 874876049, 1093787496, 1093926913, 364840768, 656751034, 437965095, 461125973, 701162469, 469612849, 265911332, 125157164, 799819682, 952726110, 705235551, 937406202, 375351761, 906369930, 69272829, 517607807, 129316440, 741969686, 833925684, 807957610, 788312982, 122323862, 443751333, 697344762, 666708343, 885185783, 64186403, 75352266, 218705627, 78113039, 596614396, 729282754, 1094516737, 16702, 547457761, 766622139, 205419541, 880, 1012702870, 291091410, 132104443, 261683191, 418204167, 265003088, 1076863763, 548379882, 764278870, 294685798, 855322075, 192758155, 380884448, 1046592453, 252789396, 169350665, 770415439, 774190347, 674422333, 282862777, 41967926, 509887001, 956840942, 1020691505, 182297916, 437569096, 1094500036, 1094582273, 218985332, 486745011, 73038802, 243503578, 572063081, 439937499, 579245295, 1001686867, 335787792, 248316766, 101157606, 304197320, 177187832, 656540014, 123438420, 1010656438, 668185045, 676097567, 449884946, 332334951, 788736869, 524622757, 709135288, 776674630, 918883414, 749222056, 156218305, 1038918437, 450385541, 656355035, 547255585, 875662478, 1094909953, 273797202, 109558203, 758605693, 1034222155, 158277401, 91785049, 103446596, 712273304, 467002690, 832615413, 80503579, 869658271, 275467159, 950476679, 1021104959, 353678416, 548546434, 231723613, 153955150, 323171517, 871681034, 119325436, 710043807, 286209406, 392220770, 568636855, 1048031903, 1041709530, 633325229, 328353351, 608099407, 821178288, 1095172097, 182597005, 487007156, 266034928, 195020567, 300600513, 601153403, 433075659, 720808544, 434320981, 245479661, 801859988, 218734022, 803219715, 1023925859, 436412539, 871905973, 792208796, 922789165, 78602491, 395130045, 296122306, 126497536, 456012934, 704130065, 917156756, 1057145369, 81021296, 393813021, 889293805, 1021609008, 985417287, 912640629, 1095565313, 365259547, 102885977, 1021862838, 1027272279, 1036092248, 1034388084, 711067888, 527606726, 424057722, 542637977, 169938302, 149828741, 550878885, 40255972, 701700161, 883495156, 322572893, 217841498, 973686303, 493181514, 484907915, 467645934, 728410448, 192976044, 364532572, 729196671, 625100497, 1094515858, 851340840, 336894085, 608427086, 730371303, 1095761921 };
        for(int i = 0; i < 32; i++){
            temp[i] = q_t[i];
            B_basis[i] = q_t[i+32];
        }   
        for(int i = 0; i < 1024; i++){
            qi_qj_inv[i] = qi_qj_inv_t[i];
        } 
    }
}

void getParams(unsigned long long* q, unsigned long long* psi,
unsigned long long* psiinv, unsigned long long* q_bit,
unsigned long long* Qmod,unsigned long long* q_hat_inv,
unsigned long long* Pmod,unsigned long long* p_hat_inv,
unsigned long long* Pinv,int size){
    if(size > 100){
        printf("%d\n",1/0);
    }
    if (size == 4) {
        const int modulenum = 4;
        unsigned long long q_t[ 8 ] ={ 1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337 };
        unsigned long long psi_t[ 8 ] ={ 876068955411733, 683350908850454, 590561596205579, 216507267334297, 50765375755589, 912787809930805, 387672266168769, 40949854842574 };
        unsigned long long psiinv_t[ 8 ] ={ 296149924052233, 60118563256458, 552459013006867, 686906613962287, 919036124875760, 62607126251635, 480355813031527, 404736536181170 };
        unsigned long long q_bit_t[ 8 ] ={ 51, 51, 51, 51, 51, 51, 51, 51 };
        unsigned long long Qmod_t[ 16 ] ={ 844439735897439, 18218487924, 26315593668, 54655463772, 22790804400, 27674548200, 38744367480, 72645689025, 844811852374554, 433347296571, 515889638775, 663286678425, 861237524160, 947361276576, 1093109165280, 1332226795185 };
        unsigned long long q_hat_inv_t[ 4 ] ={ 1047605195405017, 953089959718138, 677511161304482, 699493410391695 };
        unsigned long long Pmod_t[ 16 ] ={ 1125774831018452, 1125782188489265, 1125828435448661, 1125839264626481, 1125774497213222, 562833500864236, 1125834694684682, 562895609366536, 1125805711519754, 562865176608367, 1125859538879054, 562917347741227, 1125856339873537, 1125864509331505, 1125888350810881, 1125891060069901 };
        unsigned long long p_hat_inv_t[ 4 ] ={ 38415822041836, 1053652924911162, 926235353141238, 233495725059815 };
        unsigned long long Pinv_t[ 4 ] ={ 237434426577534, 678092178480643, 496216921449741, 245754264200201 };       
        
        for(int i = 0; i < modulenum * 2; i++){
            q[i] = q_t[i];
            psi[i] = psi_t[i];
            psiinv[i] = psiinv_t[i];
            q_bit[i] = q_bit_t[i];
            
        }
        for(int i = 0; i < modulenum;i++){
            q_hat_inv[i] = q_hat_inv_t[i];
            p_hat_inv[i] = p_hat_inv_t[i];
            Pinv[i] = Pinv_t[i];
        }
        for(int i = 0; i < modulenum * modulenum; i++){
            Qmod[i] = Qmod_t[i];
            Pmod[i] = Pmod_t[i];
        }
    }

    else if(size == 8){
        unsigned long long q_t[ 16 ] ={ 1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337, 1125899915100161, 1125899915231233, 1125899915886593, 1125899917262849, 1125899918180353, 1125899919360001, 1125899920539649, 1125899921391617 };
        unsigned long long psi_t[ 16 ] ={ 1078670787672037, 78076858349919, 246997595051725, 850840216247352, 806904958709653, 1070376746092047, 845212978648258, 245937526783616, 550377166181209, 248439862439542, 4575485793961, 1123875792878550, 99297690016608, 502434417273937, 740792064043049, 602636065456379 };
        unsigned long long psiinv_t[ 16 ] ={ 878983990372558, 414027304966541, 131095265159957, 577899596419153, 227570757791793, 346656573493514, 736742535490994, 344474795218714, 66057313883641, 354258723931050, 11258593091826, 338828841843995, 655228886992520, 258350105552322, 629138496512109, 1014534401228529 };
        unsigned long long q_bit_t[ 16 ] ={ 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51 };
        unsigned long long Qmod_t[ 64 ] ={ 1044201650018962, 934419997275202, 636240029102755, 172173777508679, 78123105873874, 260008519093577, 195307764684685, 145520734125773, 597373255576813, 862407490127157, 1105192760170283, 350727481071417, 732981607085278, 770251858293004, 535371615877412, 344232979611965, 428357016748641, 645667031493654, 416866088554117, 74904063227920, 713928361247735, 1087633916571817, 301956806608877, 517640239900932, 480083580484297, 845468800163159, 817425688453190, 925387571833800, 183078371736104, 714600945516637, 2417365131841, 887916359099737, 815592615404032, 804175726316316, 775364604656850, 302873849443306, 413328610845413, 436077512294611, 115455830685745, 488172546209891, 229959881090605, 1114465543825578, 669128651272860, 443298245626918, 1083876420594198, 907497986461924, 1054227590538817, 917980505576685, 254287923735377, 223558758185052, 464519360517809, 260818551215894, 796302019753543, 966166337964357, 590707405611892, 833874907032046, 444834268020892, 153577409851870, 274392314241332, 90597017414341, 754921723010646, 968412331158395, 531038271357193, 928586573377254 };
        unsigned long long q_hat_inv_t[ 8 ] ={ 188405498414900, 152319692169342, 539112869786880, 977803261590512, 443207918992315, 203311526371664, 1019592115388459, 979846764579373 };
        unsigned long long Pmod_t[ 64 ] ={ 683295556745142, 445692019563503, 1065325964279537, 451509368484219, 461574969757618, 120685690470685, 121101697735461, 361744706512134, 297245972564092, 871031153778952, 234681545567647, 222934479423069, 93594195638875, 289278962327065, 928785384350248, 791806364819425, 535504456238723, 801782985388051, 1016485690342407, 866748192267449, 675365553427698, 1099080118410602, 148216408318805, 697561099286683, 1025770258522053, 728200406485617, 708759176917664, 717048384739867, 877337720422023, 518141515515665, 68621371692923, 1016027344137803, 953621584412815, 559666078087240, 607034668482679, 1123710659503494, 650487795211373, 232558378284551, 1069362150447895, 886423645313237, 735948721288277, 634669109626667, 999574999799745, 203390877497500, 609049763743840, 1017539103631543, 130751278391250, 450788725399885, 164395940634791, 584788527327229, 484897264932293, 306250904167764, 7997223023283, 487101118524611, 173665434122335, 483239153537877, 511151803555448, 418215111999912, 701593593456765, 913746753983551, 403835086860079, 762050841884791, 196860491370903, 140318718691353 };
        unsigned long long p_hat_inv_t[ 8 ] ={ 156632464917344, 908759328320382, 54718575142704, 61402621815851, 919150929656431, 16629857268984, 415310063624434, 845095914122610 };
        unsigned long long Pinv_t[ 8 ] ={ 391615008931123, 669686079530374, 324127457937981, 1025471786010969, 208885675101810, 1106050441423429, 991908824754368, 885010419430225 };
        for(int i = 0; i < 16; i++){
            q[i] = q_t[i];
            psi[i] = psi_t[i];
            psiinv[i] = psiinv_t[i];
            q_bit[i] = q_bit_t[i];
            
        }
        for(int i = 0; i < 8;i++){
            q_hat_inv[i] = q_hat_inv_t[i];
            p_hat_inv[i] = p_hat_inv_t[i];
            Pinv[i] = Pinv_t[i];
        }
        for(int i = 0; i < 64; i++){
            Qmod[i] = Qmod_t[i];
            Pmod[i] = Pmod_t[i];
        }
    }
    else if (size == 16) {
unsigned long long q_t[ 32 ] ={ 1125899908022273, 1125899908612097, 1125899909398529, 1125899910316033, 1125899911168001, 1125899911364609, 1125899913527297, 1125899914510337, 1125899915100161, 1125899915231233, 1125899915886593, 1125899917262849, 1125899918180353, 1125899919360001, 1125899920539649, 1125899921391617, 1125899922702337, 1125899924275201, 1125899926110209, 1125899927027713, 1125899927224321, 1125899928272897, 1125899928403969, 1125899929190401, 1125899930632193, 1125899930959873, 1125899931811841, 1125899935285249, 1125899935547393, 1125899935875073, 1125899935940609, 1125899936071681 };
unsigned long long psi_t[ 32 ] ={ 453883536709434, 535551717800958, 1084172711437224, 1021135754428554, 139584554538535, 353524911611277, 334634139092045, 735533506282789, 229845122792805, 598436694578287, 592965527797916, 894383418057065, 332312058891113, 1067428843928355, 169500434102234, 117805416774355, 384596055264579, 748540753819473, 695553441053579, 346096041667248, 362442375830095, 266478965940220, 659294240437725, 44488197454387, 170631272517886, 710550474995848, 919530969175879, 814991077920421, 1026871490196931, 635877950964454, 791012299988327, 176303311779106 };
unsigned long long psiinv_t[ 32 ] ={ 36615780911373, 944363674359166, 455917832565662, 51130221093346, 791895997204229, 678591215521150, 559618036076339, 128611701664816, 204546161316226, 176624628475708, 454810464957524, 289845491709130, 361377986631365, 638530529754790, 301001224800887, 551757459140462, 696854874000850, 7614202019465, 468878611571207, 923942584593675, 789033649747269, 551270736774041, 748329520156311, 86493038207506, 471883867391915, 151935669202291, 535834907399340, 463166361401060, 704176999302471, 45465381076801, 800656111592072, 222601084167227 };
unsigned long long q_bit_t[ 32 ] ={ 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51 };
unsigned long long Qmod_t[ 256 ] ={ 960568605562723, 314765012893227, 943465365858625, 929951694981313, 198996477350432, 840240303112746, 1086549799819422, 406287831452070, 806639448225841, 801038387270113, 509978642085706, 761094916641379, 784980850719069, 134821214629757, 310714597400746, 850449062521932, 336780014289264, 438968795418269, 372895786202699, 915425051863767, 12283244979615, 583993103672300, 262128330913599, 235622461744321, 821761724453165, 360466998662909, 652511277685449, 580648083948679, 898080038104704, 32755319945640, 754193794207548, 465251086007414, 81115535655238, 412764352349970, 299729742329944, 807678740812065, 987060853248611, 940173668566048, 538816054795733, 775308928271678, 133261237147891, 731729405653880, 663158221287056, 65756212796468, 343208153592721, 927877505223391, 899189226989832, 686242862048482, 898307789760942, 846943987509320, 156448599209282, 226852047708568, 667066386166258, 920405278902408, 40328521244978, 674235432295449, 726135534887439, 696673709929709, 340278071562852, 78425336627843, 178298328554470, 378944214028652, 754906778495965, 567907822668176, 411787457450154, 1003644769041007, 501530602992778, 546201254740050, 575183362134420, 628838524773455, 905902490878367, 830856301097787, 579150950844342, 1046914865836215, 1120446360129919, 541928470442554, 384780647821999, 611382734078947, 586814989831194, 912890197528583, 1106863610367930, 351939568887940, 554253705637087, 393553542054481, 106876534925487, 749620407254527, 844552734608219, 341927965800929, 962199328714766, 621086781501248, 630119946061676, 145934975182937, 363910868976458, 1107484322038955, 207771829074012, 683855931601858, 299926640860276, 927736998088095, 966126115250361, 354278206598412, 778483947602809, 514652241269572, 1050741304280431, 36362220513416, 736808776983962, 604102903072861, 794889955940064, 720885784976759, 107153783179974, 708556413196824, 364479903814760, 303538216576930, 732060343892437, 1079338804565553, 18695382759023, 824935385439054, 958098506828461, 939690403946669, 1102414599907225, 738945515795812, 911270202913501, 544526754243588, 815388155360896, 909471404056384, 609960711330949, 818263988193511, 776313632603026, 861121004231928, 700126403253479, 25245010361864, 860179959362076, 978929371958777, 324250902595614, 833065676579411, 19557945171225, 638622415955430, 819644776522777, 716426015452586, 22687216398621, 703874093909066, 412042732530433, 991929729608268, 464498179201228, 443443405332848, 27305095263619, 929406054235519, 747707504084620, 280538979395104, 165858214757689, 525249746816087, 747022450163629, 764751283497076, 849022195575556, 368207410456074, 1020594650148875, 746046767306460, 279962977336726, 651928682782456, 67186687252997, 188843713956333, 623662398163390, 143358929860631, 582946936169083, 546041626211016, 504239538490794, 574043760888504, 532983352108579, 576060814521701, 291737097014557, 454250424047187, 653643846191770, 654615565057919, 861065641332756, 598944512379613, 72491066796865, 276689695470392, 614459040689793, 824456649464881, 484654847128341, 1069846331208563, 107179818891810, 570759352451982, 1041225770330644, 270044387062717, 1049249860532691, 879495948203846, 711415417282243, 1085087848973794, 21705652466010, 773913435431436, 700718518031721, 674646072634099, 569131347984643, 351483142500168, 1073148760214316, 927934180223445, 824164414748370, 528794224030357, 992889168867652, 934061565959842, 636226822031551, 988997297698044, 346423912959543, 1098885886331160, 923262889929385, 1040686498470884, 596411668204093, 293494334297022, 374208600436533, 477031617647005, 502348397734293, 884133704115163, 759324530343262, 476414315763109, 268283457574845, 235729938241246, 633113415813578, 987413163583052, 761384101696414, 1047620941190706, 776682045555203, 108366518603742, 722956216275223, 633024236541404, 848953196911737, 907775925476041, 217433030742795, 133073093352257, 795913929480442, 910367634766584, 820436451744667, 858071151365982, 839869393916317, 866562869876685, 983187795240546, 308983780529235, 889973316379169, 512722035891836, 183082468141309, 777039966875575, 653795659080888, 506612281437516, 975228834000184, 522939303577326, 1020818252498688, 1100616802162392, 918178314072424, 364579790773378, 86321738770511, 72702379441122, 645323852887854, 33479294179152, 554842305400910, 329090012588814, 724633536809024, 605845313702879 };
unsigned long long q_hat_inv_t[ 16 ] ={ 374210504876589, 299851477807592, 710980875892208, 937374710997897, 1027115383968671, 830332032328427, 333185137970275, 930100106481127, 691651082297357, 914215033790614, 1783372450776, 928559542504837, 234149446050323, 529273320565796, 471914912301447, 918402288605162 };
unsigned long long Pmod_t[ 256 ] ={ 1081678776272667, 105335740100004, 486266864909200, 346319508531969, 285133647965655, 1002750939697132, 474985381386516, 516596755565279, 389013491927360, 61770468322034, 714007009656781, 495834732760492, 802075328949877, 978081486401194, 219899666728022, 1123800996228503, 1033823666885055, 119737674054419, 807178610219529, 746929499592718, 572533074731851, 1022381938420647, 821747636683328, 675601876441968, 631366039293982, 747575324721518, 675594878557820, 839354984504101, 721609446103857, 856380234387323, 379126603331888, 519733863355223, 546106493806545, 880201370419438, 434743600951877, 906006719523253, 759415847579425, 654676083302872, 945224500363846, 1049335435969071, 81534336536540, 696289084284420, 847595625254663, 323412954135966, 1048196224332148, 923748260229173, 65227469229232, 867145205806910, 1084263865032324, 518076422650528, 943750492520456, 287041494055425, 663367725510187, 649285666582206, 106106827832638, 7860717479942, 72677693612619, 875738301082601, 391355721309814, 653112774260983, 716513155431219, 923846302858261, 1068340034631303, 581602464650753, 471880419368160, 640434751277581, 423516459398299, 343185759540480, 453871230971413, 771151128281365, 534113495354997, 977543415096423, 29432860847502, 431585265158451, 478110947551988, 176729769647033, 985961643610571, 533873858040945, 23125819237323, 929649822339780, 681830056320186, 221559419255472, 689383541415219, 964630087363402, 831707409852782, 404828685298515, 704841517702075, 94238261071670, 608010867200956, 1102427368160330, 399717946190961, 8533722696444, 969575286894455, 273245991936598, 863990089394975, 253152789167374, 482541814198764, 961145408963480, 633328384568423, 371665307262356, 926586814846336, 525428222651357, 838233235957279, 899785534141853, 142362284760881, 728032497379264, 24219565080118, 1003819980663461, 201059089249485, 531588695759777, 316047517177806, 693873955941791, 621610537792152, 551710851557452, 916066727753075, 972710518413672, 922846956339945, 852534807285473, 493976014963524, 869620126487027, 68710251383987, 852331501513027, 601386784351376, 188286809438024, 936540499367806, 714955538117931, 826392056896901, 807679644216551, 441980151477151, 1041752074569736, 117526785408006, 108486263453544, 636204284120319, 770410396818728, 252560086558372, 861636220782645, 710393623382980, 304907834187408, 527789377602986, 882941821204484, 63283653681234, 886287950321080, 232036779475952, 1018716490174340, 841640132657135, 940028786810510, 116781812573431, 345388764810980, 819618421060178, 985688781801473, 628588422060481, 735894697396244, 552016904595108, 259041573608235, 970285882445, 70711048096902, 563741836093870, 679893543562517, 952091011693031, 386693626064349, 1074033435093939, 380070952813441, 716022290062626, 1107415714882694, 853920662185784, 537388243422171, 903131270720658, 112085634949403, 1036874080735652, 1112237680361972, 42668661810602, 499082008642367, 777655560551739, 303472716982615, 365030971404476, 304172333102546, 504313551461837, 1033064670321180, 818799405365676, 152467960925262, 875367882036995, 95013849251708, 1113828905486857, 953781951049922, 740540768361906, 124858497271065, 193621282381060, 545252424831149, 287235204151503, 405075772512034, 91562897998781, 275305651710824, 774350787308433, 1046669904659308, 1102223954670140, 320719296745620, 950125352744393, 544347416332152, 364153231274506, 498985131637806, 405653171610891, 741682552291746, 836064882546056, 360009966968485, 1013121089421620, 160359648372810, 845278935647295, 47244715273953, 700131938918389, 1016521679757305, 772978890678426, 247447259561349, 1057538519608316, 403286967014396, 185316156598535, 1071210799558653, 57040876392778, 373480376878858, 430887503045252, 119141273122131, 591274983733271, 557204053116341, 715208768704656, 365206371655678, 726645841981872, 124400245215913, 758961293233284, 242215280660624, 632467744361070, 737539901149340, 1100547542976734, 181661460495468, 638238360655965, 405734024684460, 1003477338933927, 737078678992878, 694704381005064, 362298754250183, 154741327282289, 286453205428051, 928699850892527, 729199910785226, 695822150233553, 215976709509890, 373153887594849, 927495157288226, 163066328004289, 553460451397466, 139715581129377, 1068039639915259, 1079851486334028, 809888614750521, 982540664338929, 990878656224246, 895126056038330, 505132100065832 };
unsigned long long p_hat_inv_t[ 16 ] ={ 654932108330389, 59585156000255, 1045299638360992, 1008477162811059, 698471901836315, 149299068941672, 996955829848996, 123245843114011, 310528922801659, 161432625498020, 208067849879016, 119447950691352, 168345644935924, 266139735976304, 670852955881019, 114317178400416 };
unsigned long long Pinv_t[ 16 ] ={ 476563968758305, 442071514021230, 1118965008944152, 914171612725686, 430323388164952, 740374290194101, 1091371664045669, 246405676261065, 906499761054404, 387787438509028, 101879985364438, 984393577357316, 111679947308619, 1072187713823427, 285115875120766, 69159416899680 };
        for(int i = 0; i < 32; i++){
            q[i] = q_t[i];
            psi[i] = psi_t[i];
            psiinv[i] = psiinv_t[i];
            q_bit[i] = q_bit_t[i];
            
        }
        for(int i = 0; i < 16;i++){
            q_hat_inv[i] = q_hat_inv_t[i];
            p_hat_inv[i] = p_hat_inv_t[i];
            Pinv[i] = Pinv_t[i];
        }
        for(int i = 0; i < 256; i++){
            Qmod[i] = Qmod_t[i];
            Pmod[i] = Pmod_t[i];
        }    
    }
    else if (size = 32) {
unsigned long long q_t[ 64 ] ={ 1073872897, 1074266113, 1077477377, 1079443457, 1080360961, 1081212929, 1082982401, 1083703297, 1085276161, 1086128129, 1086259201, 1086455809, 1086914561, 1087635457, 1088094209, 1088684033, 1089208321, 1089601537, 1090977793, 1091043329, 1091174401, 1092616193, 1093533697, 1093599233, 1093795841, 1093926913, 1094516737, 1094582273, 1094909953, 1095172097, 1095565313, 1095761921, 1096089601, 1098842113, 1099104257, 1099431937, 1100021761, 1100808193, 1100873729, 1101070337, 1102053377, 1103626241, 1105002497, 1107296257, 1108738049, 1108934657, 1109065729, 1110048769, 1111031809, 1111883777, 1112473601, 1113980929, 1115815937, 1116143617, 1116209153, 1117126657, 1118568449, 1120075777, 1120337921, 1121058817, 1121124353, 1122500609, 1122697217, 1123418113 };
unsigned long long psi_t[ 64 ] ={ 1056585332, 362355510, 392633829, 32775764, 552451052, 778273824, 90918200, 250723334, 37780820, 465607621, 400989402, 59570020, 673749417, 235136719, 999531690, 954577903, 956756045, 623563973, 752925324, 168826678, 37053747, 330611819, 576252306, 1031843728, 164803792, 772691611, 1036716613, 904985042, 580529733, 393074673, 821000000, 312887712, 968110705, 374521769, 1051723930, 521679649, 685165624, 987816507, 448701333, 49287131, 983821483, 266001963, 783020927, 250855208, 713365433, 1008170496, 499892521, 950018936, 364857577, 22109432, 98303796, 220382780, 545577005, 1058855516, 808525522, 125434411, 802491111, 593854450, 659042797, 667181939, 988636035, 89320761, 31860191, 790642536 };
unsigned long long psiinv_t[ 64 ] ={ 172893228, 21887459, 666026948, 33763842, 829803950, 1001086973, 297444873, 855265237, 74190689, 26869472, 965519191, 636493110, 1040694784, 576532642, 877918892, 409052151, 1074978949, 59536250, 1087646493, 652801530, 960101445, 568756837, 707647535, 919603661, 597972385, 353870859, 488151770, 109876772, 102331650, 5408515, 390147519, 549957278, 974858279, 418972814, 1056482782, 882638300, 734812716, 1053211658, 1081296680, 515051441, 317529358, 893500102, 54593038, 274973949, 281500037, 791058898, 254859703, 377108252, 503942375, 25196859, 950430537, 1044746816, 958611792, 463494244, 30225345, 380453036, 691643051, 299014775, 324868054, 645743921, 232527773, 845084701, 541671132, 584386279 };
unsigned long long q_bit_t[ 64 ] ={ 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31 };
unsigned long long Qmod_t[ 1024 ] ={ 608373537, 471215006, 1054247342, 419269588, 845626501, 189080522, 795533881, 256093791, 532490619, 642932622, 695348641, 642431903, 510140058, 400697638, 513531896, 729031010, 680186744, 887484365, 241119324, 827882869, 294607681, 540983277, 482238648, 379551286, 944470631, 470273893, 783637803, 674740803, 1044850404, 717042176, 158734207, 34756811, 328168416, 210348794, 639706034, 184818484, 1051246582, 11378037, 761858019, 955114417, 604020128, 667152242, 101788144, 923174929, 71155335, 152844306, 923197422, 757034011, 872984305, 1003651051, 382629453, 755203520, 476966781, 714656596, 688952017, 24523123, 667659025, 1051743970, 595795177, 199234938, 765258906, 505965367, 478773842, 813268927, 843866652, 575924929, 984511094, 863141352, 797788414, 260057061, 194773936, 564023047, 1008436146, 908115652, 872520740, 857609035, 328514190, 537581526, 285204692, 446513067, 1023360935, 648805290, 492771285, 389547872, 686658880, 717127047, 589559962, 570409384, 876488613, 759551077, 244849558, 694411424, 199110188, 1018393989, 765180791, 616231851, 273551058, 1068041998, 433328449, 313739650, 366614820, 257205362, 13300042, 169662485, 1043627601, 926319586, 1088691394, 538812690, 598853069, 592693959, 648451285, 409179042, 683877645, 271459976, 980423934, 1005262120, 1003767361, 476100499, 85955981, 346338303, 371203964, 955935073, 542919952, 193684188, 876938714, 541874411, 37947095, 884186641, 1009949109, 563526982, 522282782, 824416700, 496215559, 545522021, 64854063, 650863168, 294946825, 930498232, 708879370, 320594375, 194312458, 298745184, 564086559, 669734190, 802208129, 873990389, 1030902443, 773458533, 858251962, 723569383, 970339628, 890443358, 61703566, 287766153, 672176664, 852567743, 216180210, 614359759, 506800067, 259416252, 811168965, 823186283, 395362390, 485772828, 592247880, 139385530, 420329464, 480221058, 264099701, 824916690, 267068489, 89772190, 331590974, 870020223, 543933756, 760805464, 764095875, 501219890, 351229036, 405302099, 942499282, 1081959759, 534136978, 1079389518, 142587634, 659014079, 823997417, 902195802, 952317791, 817410308, 108150346, 598435146, 100786176, 563232607, 791639359, 934965136, 340177171, 402622710, 527125133, 553458149, 637022174, 536830280, 428101871, 749189828, 892684779, 478057381, 958149932, 294270910, 493037085, 343824908, 522871598, 805245420, 964893835, 958625500, 528016823, 552609294, 751438507, 620218175, 269192498, 432540672, 480501670, 59713465, 268002190, 193627372, 834448221, 6753219, 1099567158, 999333202, 26162716, 543298370, 859746552, 538105658, 299292522, 866892615, 562756702, 846829388, 731541593, 722455371, 197461554, 521456010, 1055497758, 122744356, 1040357953, 320307325, 499554363, 507930820, 521893253, 632714893, 590297980, 439504132, 214802623, 394923108, 767335083, 1095057621, 622740854, 115660353, 325908190, 91395309, 447178283, 246486530, 213628879, 121860412, 42276048, 894092355, 667961001, 254710831, 778127871, 273953328, 282254944, 737189042, 942504495, 319612216, 647530006, 157553600, 972696426, 388100548, 737997998, 85432847, 823684003, 351658382, 884818523, 348063101, 739459590, 629940459, 375740530, 180139526, 1025945995, 679175959, 920499514, 1021511884, 178867518, 381833585, 179275369, 208678771, 447290771, 924530018, 89342277, 527702595, 260984480, 137603435, 422697277, 952858897, 566560487, 864831277, 1016675277, 147839229, 924455363, 544150661, 596347036, 148903795, 664088795, 336620048, 828947995, 1093685753, 156150783, 85306686, 536602554, 270918401, 41874514, 208465313, 1025893114, 977759412, 870830844, 937817832, 361458604, 487034511, 1088538555, 904380899, 289994436, 717460399, 575659091, 917557296, 28000527, 45842096, 338326842, 483688354, 96258010, 357333267, 314945235, 830016561, 984519419, 93508825, 100989531, 844588851, 394141990, 39190195, 628427220, 444737659, 1069081169, 670322368, 329918301, 595555445, 19821547, 560523548, 399428371, 909622862, 283234622, 988023854, 761465952, 120355213, 840785322, 905478435, 621360277, 888376944, 609295764, 365885507, 710972761, 386498775, 301415007, 898671122, 575593, 853374628, 176129580, 153881726, 680878761, 90752914, 382336684, 603201996, 562900780, 828357113, 18334452, 413766294, 668890047, 799829246, 632743227, 901336340, 266389739, 648886798, 938729547, 1023222364, 958101696, 527103023, 413781923, 377953970, 574106130, 350902174, 1100766739, 563341832, 625137786, 513084421, 973330197, 773101342, 571167368, 729327417, 842334298, 286675874, 437788493, 550077513, 367662814, 979250618, 1014755307, 634474759, 959535985, 999502633, 383953698, 87388074, 502070466, 231055434, 1044758286, 892621907, 936544647, 926003419, 157439023, 827298075, 49829548, 64437372, 885293288, 113872377, 1017254127, 212306034, 405289096, 697018886, 542388395, 684988542, 170878715, 569583752, 827491930, 811532610, 1001445360, 1034159263, 269895468, 761346085, 61603310, 694838175, 146241508, 962245809, 305616927, 12255630, 739510199, 27286818, 227943886, 792698399, 488861031, 942221586, 565858766, 682245709, 351553732, 827250289, 1055092535, 678505260, 810682488, 603930109, 246297227, 906026177, 443130030, 552906309, 848131575, 952039847, 1003702128, 40051942, 173446742, 615928205, 300182776, 77127695, 1054433850, 1044149853, 898879391, 183437483, 156477437, 699664331, 963616347, 608255394, 808934643, 528123533, 483184262, 663967476, 70373199, 561051650, 138558612, 1058903657, 401154964, 811515804, 811885115, 562109065, 673261980, 637368046, 939641453, 509422555, 431746990, 548068404, 1014394755, 722711655, 207837918, 1040096908, 855734589, 889766141, 10223463, 955689675, 630386372, 670834998, 917933, 454115613, 62780637, 461522308, 358132523, 7005599, 182891138, 283347897, 874909633, 501001399, 158425915, 412366022, 649686860, 299354176, 594882798, 883968171, 479455447, 400881278, 917649702, 170015883, 475780295, 1041962953, 293485637, 1107233131, 832396873, 747813147, 224061936, 1094171564, 974530290, 907590136, 646020943, 362872381, 1097093283, 1096913817, 479004599, 7489997, 349166755, 134474242, 600709990, 184997132, 786302634, 387521604, 48930126, 398542839, 892540228, 74125519, 165955639, 780922987, 82293623, 659173210, 410904181, 359290996, 668756766, 482049322, 34716965, 67570174, 1071644082, 848326049, 893804064, 624386222, 356082431, 530110148, 797923188, 849682587, 361101643, 758732511, 1012388965, 433177972, 543758165, 827755656, 183921657, 35007032, 126105342, 382676000, 632662699, 523056619, 419986910, 596897046, 402230841, 601763426, 583181727, 661998755, 629911110, 226352080, 539312661, 1020652387, 260182289, 451635324, 573597982, 336098797, 608972393, 459967002, 840486444, 415690687, 228348128, 771189088, 245822657, 353418086, 44732687, 1092979429, 641139604, 555035798, 385605237, 1088527111, 660793916, 941760659, 535563601, 821922101, 1012788508, 924538632, 959089811, 866176398, 433113783, 567308612, 284611194, 971964202, 1077721929, 441057801, 885343674, 193324522, 1073189554, 363835807, 855650524, 89465374, 969858390, 589263132, 1081730186, 728067233, 295642174, 739616378, 286585352, 88661843, 695004808, 642101073, 664904886, 516439205, 724672637, 101054516, 1059252051, 764511594, 1012837095, 250005369, 1104119184, 296799601, 225213159, 448420911, 314344405, 904862938, 9942637, 172323111, 392841796, 1091788491, 736363475, 202022371, 333340492, 529100987, 1027845467, 758951598, 1008701572, 653114108, 37472398, 1066140736, 440165640, 302815657, 27173508, 427251952, 924731271, 811170617, 887541686, 1080887175, 297079217, 83745070, 328880710, 737601105, 15926504, 229294577, 27027559, 1109121966, 796682333, 204940708, 251027891, 1006464509, 472717799, 1086185185, 483222487, 825310575, 668913950, 185576406, 1063258954, 276030371, 256175885, 747690916, 1003690634, 553995100, 819955090, 862523705, 988807507, 98577715, 709200047, 761999965, 320430329, 248771888, 72233314, 740600070, 555770957, 384882109, 408389131, 559498727, 987531745, 251265500, 136937639, 182949886, 781475615, 693400073, 661966278, 665212801, 492114569, 451480933, 1052711102, 441705518, 534649232, 725686692, 410574581, 151416957, 1079160102, 939277717, 322957712, 653884416, 352317504, 545553894, 774230246, 959758310, 750048423, 1075078602, 755793351, 528577737, 402744013, 54433358, 661076954, 324721090, 120548483, 130770410, 641964623, 507504976, 240235065, 232418118, 165887301, 44218712, 964464691, 727544669, 824677554, 1113352001, 909256490, 307871892, 905577372, 869704346, 410192170, 914275202, 599146568, 273527026, 730199316, 1036698204, 131051681, 355791868, 497081900, 860592051, 989326199, 477491754, 924133538, 231256916, 656098026, 751963292, 580463380, 444739835, 392758308, 944720604, 402005490, 642655885, 1095298974, 37580468, 437191556, 946245449, 465491328, 444168017, 7023467, 407404588, 31928421, 690267603, 71079719, 4192655, 404316318, 234727926, 576383179, 622338426, 426008557, 777225803, 194896083, 967675773, 441882475, 156735932, 70515856, 5426722, 629733750, 270369241, 900847257, 938818671, 519575958, 829784568, 929575772, 954429627, 326334368, 813954160, 828262751, 78974947, 99118227, 6977214, 213921447, 367078099, 654793570, 1015394274, 917879531, 176571838, 1045704503, 646654317, 772191424, 33697451, 761772174, 716431951, 461438948, 11561389, 994208040, 516747563, 936707278, 114349514, 713432575, 1043482810, 315991382, 175748387, 1001861906, 164273146, 487068490, 415474013, 805053761, 637688482, 382855985, 51537278, 939890573, 232876363, 218291393, 823202158, 377590352, 194800598, 286808379, 970268302, 424963895, 711154890, 704552681, 234686252, 330239470, 945769935, 104065617, 1008821264, 757501192, 584576545, 671227215, 1089068410, 307555390, 995616846, 1107537136, 129201012, 1044783110, 76916434, 1106240940, 222579257, 139967763, 808332620, 87904496, 1064692975, 433690906, 495359205, 132680915, 890556504, 800568196, 249564869, 913369132, 37561430, 61801060, 430801101, 1023058854, 880936740, 662841402, 86053259, 650607597, 886973376, 565162544, 368972802, 496802514, 355505636, 1034665763, 993312959, 150694536, 622268257, 1042264727, 640380015, 633056352, 890901915, 53344258, 1017374045, 976641871, 853508055, 706401187, 715208539, 689642065, 1009688837, 55340193, 497554233, 229239842, 952360471, 163662667, 942816589, 472504089, 1016888121, 625292148, 467147290, 571833035, 1081136791, 668332463, 105545342, 617446326, 228959457, 870682117, 671358697, 560576748, 857505568, 932879705, 188242399, 380821689, 472818242, 737809256, 970335248, 51261641, 25924352, 964081877, 685304576, 321200720, 516943081, 389768936, 834970796, 150718167, 1084492336, 628927346, 122059419, 77033192, 999105151, 749641848, 286161746, 387838039, 108201470, 539413609, 988585066, 596370166, 343801018, 492144264, 938751008, 406858526, 95924491, 802682226, 16326760, 239718898, 751588684, 983454598, 57098408, 422194536, 878292945, 448936153, 913870250, 593577678, 932555577, 358373249, 1088866430, 502621059, 96546316, 881801236, 691134058, 452580173, 819383384, 814614635, 742092378, 1076815070, 399322917, 635840812, 928754493, 801262277, 727841143, 305369710, 702454890, 974194902, 554088530, 76196221, 11767217, 162055514, 776397510, 834354481, 648725749, 279388246, 842945868, 639763824, 402944688, 67264545, 1024876038, 765486333, 368577140, 955314664, 99576454 };
unsigned long long q_hat_inv_t[ 32 ] ={ 929360942, 1056162364, 444548770, 957188472, 277999787, 704367080, 328615825, 431434495, 401817410, 515193820, 1068692448, 915717994, 780276758, 24777068, 844041401, 717764740, 572834725, 796898060, 38412960, 1054251307, 654682991, 987203243, 1091539308, 700267663, 443336955, 61789692, 399025962, 1032309410, 168833690, 396708369, 77594698, 698350332 };
unsigned long long Pmod_t[ 1024 ] ={ 55745541, 937448034, 1047647365, 552349945, 652930176, 916052100, 215289992, 635519901, 850601591, 252141908, 849145759, 485554246, 489697632, 1024891732, 215170017, 658715468, 1056065437, 241802372, 338384355, 46670906, 621835736, 209110095, 213773421, 1058574670, 1024427100, 899612636, 514365037, 791381298, 736664508, 938694793, 735996076, 1060517302, 966636737, 93495950, 149198690, 443798207, 466436908, 961898268, 414458077, 1054927083, 624891343, 73465288, 1048238975, 542754084, 850910967, 238891495, 952146024, 418367915, 636971150, 345556499, 552126987, 79129001, 156966795, 685306375, 910838592, 457691812, 461866329, 483553684, 1023283777, 193544157, 417141509, 138132446, 451565576, 46747975, 1000379092, 719459211, 651967000, 835217172, 1026355274, 459073584, 756583911, 238477291, 573730960, 109850143, 50483767, 958312027, 1033832858, 986966001, 795094566, 725570535, 992622962, 255882489, 306049056, 591313666, 146755256, 1076890317, 358573059, 159713386, 853524547, 994061632, 71961222, 712396512, 623963817, 491967294, 1061359784, 260805690, 188604584, 716151925, 346788747, 783498545, 688849502, 908520121, 189413851, 511524944, 911675647, 992795079, 681931135, 1006752144, 863023191, 231192498, 593168207, 398446096, 910091485, 700831115, 1054556018, 846717647, 741762179, 301434342, 173903678, 978782771, 716699600, 341904790, 21415663, 291330525, 204313313, 69629646, 255762472, 552398149, 831321225, 408684181, 289643742, 318080271, 665056980, 805687244, 413078695, 303172284, 1017289837, 1018510530, 576603376, 666817519, 977255919, 705397225, 1032697623, 132782627, 177004509, 1077387895, 561515023, 786949933, 59262745, 614729991, 86263617, 20560226, 447851919, 286449556, 273944697, 509172428, 213078319, 654729535, 529604862, 688465082, 60116778, 14556105, 394549573, 951395353, 718126864, 31176110, 715840378, 698047771, 430518184, 495149621, 984771956, 387447712, 202396576, 791410753, 823302893, 488072985, 20487158, 320254995, 1007820742, 213261641, 947333952, 386683696, 572235954, 904867655, 945817530, 863550875, 979107094, 481249086, 512415890, 855739670, 370006234, 555081087, 568875225, 953459274, 171943929, 13190598, 604209004, 896076960, 214443013, 694745572, 346320468, 258049438, 106548548, 668638444, 603651498, 943663690, 274982702, 839264555, 427770838, 957879885, 613827567, 840415294, 317884842, 1068122749, 781920023, 1010348061, 484763566, 1077351563, 655597932, 622681609, 173160234, 910669934, 906161667, 482791010, 500362505, 212350541, 1024972164, 732692753, 340623228, 698653182, 472627872, 479545707, 473207603, 749552694, 757806077, 127227403, 698631774, 344150984, 950030347, 599175270, 398304391, 963397642, 306755206, 648026919, 580033858, 388084465, 1018733998, 791027359, 1047574852, 375418666, 490989733, 1049983415, 42255340, 1029269560, 987652964, 504770060, 911662940, 1025532011, 213993353, 394943590, 1030311543, 785816449, 860034425, 331458235, 265403894, 459710221, 175247610, 563971211, 20022156, 816526633, 710376653, 380721503, 904685953, 579004743, 532451411, 298834279, 15381828, 582050674, 622205166, 778461685, 834476334, 914829979, 1001303593, 514024770, 374201450, 945039962, 1027505082, 336780041, 59651696, 953710385, 199387098, 601105336, 964953401, 816283743, 653357023, 401810507, 524506271, 391933832, 272844646, 411410726, 1040000914, 712687489, 652756971, 224212719, 458311930, 1078798990, 940380, 920903904, 259778964, 807121390, 852688800, 133981954, 296980465, 793309779, 113082283, 520339035, 195966916, 88745583, 806514477, 1060068795, 465043681, 600934576, 34456727, 833432240, 176994172, 637160628, 600205583, 193302351, 239865979, 386205012, 988333411, 400045324, 330049330, 917409393, 743579463, 515351366, 943198363, 553456635, 853303381, 542403439, 759218651, 596054306, 937028640, 680854411, 588777221, 476221982, 489270416, 155916502, 355723805, 809719266, 723294726, 990885309, 523519802, 165747444, 1012337275, 454519599, 812655550, 366286659, 517713220, 369460493, 67713805, 1015269930, 387106308, 856979423, 590627568, 1000405493, 487593330, 195662989, 14003540, 517560240, 1017583399, 943750997, 137828191, 277809983, 528470886, 1069818753, 808929426, 747247464, 289651741, 577865778, 317995650, 207085288, 785535935, 356052080, 110044967, 168258787, 386698132, 217236884, 185722933, 1077554478, 1057186881, 91453489, 988924456, 294849397, 544143844, 989666599, 323705805, 136428283, 675862572, 798018025, 408107883, 368507795, 150981738, 921572852, 429686, 999606416, 7718647, 613421426, 392322, 593236977, 690881979, 786864263, 787439072, 594849201, 418391116, 447204535, 315394844, 1001182396, 1052878944, 298542002, 854039527, 1046552568, 912147600, 341717523, 244261638, 487687245, 756861687, 614179384, 430351323, 566934816, 703163622, 500591198, 644074242, 586169943, 408674559, 523276284, 529672636, 948637382, 1071190445, 771998075, 353499254, 108560728, 186157188, 233324878, 837346688, 632561615, 385058924, 337461200, 559561608, 602031427, 1028116430, 954375149, 363133669, 407976589, 48766302, 146945074, 182572641, 715018049, 62162768, 1031422427, 185630693, 255734738, 811784678, 921598019, 928733570, 475822480, 499410459, 864248513, 346594088, 495081663, 318919467, 895871258, 617147209, 139890402, 563375212, 55679981, 1068101616, 981853783, 327127955, 631335934, 582992131, 66807904, 345857047, 992506035, 3220051, 850419295, 418567931, 843941469, 925977483, 828506169, 929148931, 97796372, 617318322, 40558554, 71803053, 111913012, 426252332, 515161871, 763313535, 224256755, 124940141, 892543418, 543076266, 490438837, 958595101, 501184877, 1040249292, 298642537, 559763259, 973721721, 363968028, 430362324, 389298148, 122468917, 104798107, 513383366, 940867753, 581701581, 890510136, 382296806, 364153768, 977952895, 422705276, 574314508, 597706557, 667740627, 70199854, 786177054, 662449485, 1049947886, 421963768, 350184668, 250916186, 743440213, 902902027, 1077775354, 703921434, 655672086, 452946604, 756458440, 929357394, 200535377, 109834094, 1042319061, 315489596, 893821303, 688816323, 992736240, 114202840, 297346770, 105571230, 72629965, 267612093, 54302067, 100452167, 188319621, 689079828, 449377671, 468363711, 728723547, 845241027, 886631327, 801325560, 505742181, 372276090, 125546414, 12519786, 665863382, 514393092, 1058354667, 661346404, 310230075, 472685544, 222836621, 478270429, 35190410, 335872210, 763805833, 563202775, 101599216, 105546, 829240225, 563647902, 495993577, 994231630, 565348936, 336537849, 184078846, 273804632, 915837437, 52773, 1079780652, 834324735, 277065099, 944671520, 559517288, 1067987669, 443247659, 634788548, 229716040, 155518368, 412835213, 68218624, 556216490, 436422781, 968528239, 802484834, 614944181, 360131543, 682279428, 420594163, 941162592, 1030646971, 266655070, 846767145, 894342887, 1028802926, 627441728, 703882543, 556151230, 106745082, 549183083, 362687231, 287494271, 148153515, 440589911, 438473155, 362900205, 699699818, 414243677, 313720864, 960601032, 847938502, 262087220, 452566133, 425021306, 1025476515, 469185357, 357844496, 963864245, 902710791, 914406733, 523459601, 927032995, 501505995, 794599710, 744993993, 166539786, 519598037, 40466933, 41610861, 102225641, 20546151, 716898671, 1015416829, 64584935, 968899044, 114111556, 460127352, 881237078, 165551695, 968156021, 871357824, 1038947590, 811975443, 264866570, 961327779, 1017104423, 114719623, 125659181, 900720860, 596700021, 550400279, 606097219, 173256936, 417069474, 209806494, 373224591, 760482560, 488700130, 665422240, 570361920, 871193771, 427771440, 416164633, 937712622, 734353443, 762771389, 990347711, 13745042, 467692022, 1004464526, 474388337, 318649799, 266168896, 624305997, 43314234, 126989907, 226526720, 256030943, 973806116, 900206724, 872899173, 203874048, 160604259, 563342953, 35093706, 397655288, 262092653, 115538453, 631982627, 548933203, 1032361605, 559035883, 142020794, 482861894, 719883705, 408226933, 206377132, 766896144, 490361077, 908913269, 203298213, 703534093, 555540275, 912000199, 849314822, 99413822, 483009316, 331375330, 202471699, 241430947, 765545854, 174984743, 731630125, 999355078, 138337388, 1049949569, 427114277, 833186207, 53641028, 167091014, 293664879, 775178618, 735906650, 148721624, 281613736, 721079037, 652404843, 1022594259, 596877651, 103725921, 19762484, 46279625, 352408171, 150526018, 647794308, 549364802, 132521717, 96891365, 696938158, 1074128020, 55770609, 336188844, 304142702, 497964332, 346816028, 869608235, 416253656, 686386135, 71833472, 271154008, 844175036, 698389245, 53875104, 673222065, 358691758, 388804744, 955117616, 230013365, 716338212, 593393992, 198665053, 905555159, 866384285, 258863267, 1010588906, 445045494, 954856290, 260841628, 477558808, 655415860, 484162533, 1018292720, 670644199, 855368222, 29691334, 387871889, 883766103, 903396860, 253097654, 636447886, 1019637960, 802669951, 619128319, 1079706726, 285195857, 1070192541, 190864511, 12085548, 288920227, 652254366, 714610577, 609709398, 192432081, 967792172, 170313451, 820984494, 29513154, 434836244, 607997644, 111764747, 172567237, 320251995, 1052133909, 456858651, 227023990, 178714583, 589495026, 1087993320, 151094189, 470716952, 738707096, 965131413, 847437233, 717973635, 523778238, 184676774, 927495618, 264851042, 468243675, 434641173, 986419454, 949692467, 591129773, 617894445, 996887763, 254916131, 174592746, 161897567, 576011360, 944151472, 1007622175, 411929630, 60175238, 156081225, 874414459, 1022104602, 517250801, 984248876, 334819650, 874582927, 163408776, 568845885, 1074661342, 346585328, 723081205, 156516535, 627491177, 294746923, 417097528, 868826446, 63192057, 908831739, 86612504, 454654550, 1036718447, 2905940, 810195979, 837547500, 957569397, 52164349, 603749970, 312774702, 1056006389, 384539095, 698480843, 549141139, 414450149, 589727753, 1071134844, 673497041, 406972202, 1080659520, 284697047, 250215064, 778349157, 561977733, 869013485, 441071509, 769185934, 374651822, 346470814, 917812146, 831687904, 237058978, 702419096, 856207029, 616449004, 965955311, 338589918, 103309413, 377413827, 861537011, 1073648407, 127159429, 829920577, 225726612, 491179411, 932759386, 433098556, 327320573, 369097060, 808959628, 1014970120, 966942893, 27878455, 681602420, 32735285, 829562894, 190166916, 596758729, 450181850, 820340793, 546559703, 126777944, 734479436, 546893862, 952204444, 180072740, 340817914, 367239718, 260457070, 523069958, 300577076, 366854597, 640586352, 802942280, 974941210, 309449321, 1048835289, 442706051, 731398468, 606432722, 440403117, 209104307, 427057568, 838892549, 183619859, 387295714, 329017131, 140287966, 779120154, 156025914, 232042953, 361571307, 519413436, 813881617, 823362016, 1090243696, 566061386, 394174226, 160260699, 77347651, 1076433008, 998414635, 586789135, 868543667, 672636922, 266688426, 1082810443, 1069057300, 509185848, 394278764, 709784423, 540173861, 424321540, 677060878, 748362512, 758105974, 1006656583, 80949485, 565681528, 829543639, 420712947, 989731783, 717828992, 620190213, 232936853, 264893337, 120776073, 754078011, 641768520, 65877858, 58558096, 466550483, 575308608, 515617430, 853947603, 1035990445, 741599742, 333384479, 617999785, 914595567, 880055654, 869151716, 335596688, 87369217, 109813533, 64102710, 845410688, 737440319, 44206994, 235202504 };
unsigned long long p_hat_inv_t[ 32 ] ={ 247097910, 1078135073, 1076152118, 153946886, 74656759, 1046538955, 1086682717, 605861709, 406127686, 359200330, 973818159, 217693880, 18134379, 998549152, 631652306, 755959565, 105471841, 649407225, 302331070, 734067436, 802663351, 871805572, 776160340, 965434478, 407408437, 1020626019, 555893227, 226924586, 851475182, 433767112, 790968287, 769438832 };
unsigned long long Pinv_t[ 32 ] ={ 631548495, 210462892, 430532439, 745348672, 776389488, 325825533, 427488575, 602646103, 33860662, 349073961, 825788253, 413437054, 233078533, 58926045, 192835359, 516722858, 356504618, 657192996, 940571840, 213207635, 1042931347, 783486348, 236652137, 1091680121, 323823608, 703647226, 564968934, 413274792, 310881771, 742862497, 988597933, 673050548 };
unsigned long long qi_qj_inv[ 1024 ] ={ 1073872897, 2732, 822801205, 406378907, 818455440, 598528733, 1059608799, 86696374, 785889729, 1074511874, 1000048241, 712986711, 699121007, 683656652, 451283389, 183053141, 55856908, 1007881491, 163019734, 124928689, 719183191, 244501584, 590508252, 47231916, 856327062, 235945075, 823493598, 62349676, 511640217, 40437175, 824156434, 990778793, 1073870166, 1074266113, 241883012, 150302462, 104551238, 591607230, 146569171, 180617331, 930236808, 318037610, 89037730, 595798436, 433639574, 575807088, 603350896, 475062199, 630594364, 27938572, 25670131, 1056948290, 279137702, 998963436, 223170199, 541238999, 954318575, 787627433, 967000278, 797985840, 646518311, 933814505, 896678123, 53451852, 253824205, 833103998, 1077477377, 251870689, 761163779, 531122430, 863807588, 536148121, 355678881, 255075671, 883599026, 745451552, 777445947, 961329511, 208215661, 541158827, 638921175, 954137652, 121808281, 685196374, 46988451, 614892302, 923924457, 911332762, 149353716, 688607446, 282048608, 960380679, 506293011, 1001879721, 789918529, 51057067, 669591143, 924684548, 826065441, 1079443457, 540181658, 400449844, 742043803, 866962892, 646288237, 521767597, 678912160, 903687697, 581594779, 626478156, 898502162, 308846652, 643290932, 224950102, 948406926, 468470676, 146302806, 250051550, 849396019, 734129192, 769153316, 579137853, 128486820, 829229067, 78870703, 990218174, 485433479, 44006570, 260332658, 970304700, 318345215, 539720552, 1080360961, 249511945, 947610014, 63747577, 217055453, 925677571, 905216185, 105141063, 163037350, 411537890, 285855399, 668640718, 605115857, 440477335, 141423150, 1050882327, 495988465, 116857436, 881355600, 600938275, 827016449, 776846729, 380040611, 670873083, 754600178, 373133930, 656394807, 46628238, 479407397, 486459972, 548189956, 679648974, 831045625, 1081212929, 401105205, 798518654, 910231886, 188262430, 874650481, 1059294621, 1061928210, 377343083, 134716584, 267396224, 1053496709, 119175298, 51254102, 640078864, 1019386721, 1080057482, 244300170, 682776329, 808953261, 1082649402, 145576200, 826302386, 843447460, 622140096, 365188514, 375125778, 23176995, 928876591, 218060702, 339824487, 135044708, 680763085, 1082982401, 492593911, 775197731, 429926063, 543129932, 20499479, 996338624, 15319043, 850945684, 763330375, 859901481, 140245907, 903186670, 913638045, 872939654, 497995249, 1025612453, 614305845, 762342657, 235816680, 715167281, 6184175, 992638236, 253185037, 656198061, 561929276, 987962956, 895221647, 544409449, 215888438, 1016809993, 284529284, 590716171, 1083703297, 690, 205484148, 425, 931248231, 177455777, 217527368, 259843641, 401094336, 466803764, 508480902, 796119080, 77931815, 631732694, 706987071, 87482807, 680783739, 1051180527, 107, 179102840, 540697368, 787566906, 1013816551, 847398677, 666985608, 296240705, 153466490, 724354401, 436628629, 864288549, 174388916, 309423071, 1083702608, 1085276161, 835484451, 1105, 921, 652149400, 461, 253045551, 753704650, 277, 594328363, 489059202, 991857761, 185, 312176204, 156219232, 792213749, 84138270, 298343830, 1024654085, 323749804, 916149258, 217583971, 286103150, 547881065, 11485184, 759701912, 824433323, 560887125, 159598591, 893802468, 654301523, 878677902, 250447071, 1086128129, 543137888, 651876801, 634034876, 520174201, 471508044, 279150178, 69524289, 1027926292, 103200827, 189114399, 1062832425, 1070543307, 938697215, 930518792, 822684194, 1075541727, 572911235, 797602716, 433061524, 817411179, 874930748, 924316292, 85227921, 986211424, 201021776, 404791138, 180059977, 210625681, 541490870, 1083702873, 1085275057, 543055778, 1086259201, 5526, 543458939, 310753778, 505187190, 676749983, 726139250, 326, 863690984, 1061151959, 222, 585732564, 591099446, 947135199, 618232577, 364642447, 964217258, 232706599, 970488494, 136896635, 285464319, 944622461, 369143723, 485152350, 338186210, 181588465, 975809723, 27030117, 1062548459, 154814363, 1085275241, 434447937, 1086253676, 1086455809, 155275878, 922, 348190811, 384241912, 933607528, 681001307, 948676583, 124690904, 818381032, 348707473, 546767003, 431420034, 761750824, 806051556, 347042028, 900382327, 76389196, 65875139, 63054239, 540164445, 383140499, 645672812, 306781639, 501846375, 918306652, 24855280, 90248258, 906771809, 434109802, 452552006, 543127943, 931245468, 1086914561, 197753410, 785846740, 887076494, 466804041, 53151700, 545489165, 380999522, 839365180, 1067498771, 768721873, 139380458, 885453935, 156, 254758350, 711010850, 421809709, 738806706, 655679367, 1055178270, 398866998, 505536914, 125126299, 457683894, 671575584, 706098071, 1067728895, 866962362, 1085275701, 566674825, 775898640, 1086454888, 889292224, 1087635457, 932654551, 816514063, 544604853, 435841169, 128350655, 167853140, 727449909, 632567489, 874827143, 408597699, 930890255, 136741038, 281447320, 41305149, 414290403, 542824576, 217302349, 388818881, 628487749, 478582930, 871293333, 188084720, 796537179, 947348314, 236034414, 824908233, 832885971, 615472054, 581923980, 738789287, 301919790, 155374123, 1088094209, 483861416, 576640677, 1042228280, 520694325, 315190665, 742927606, 348370622, 184451668, 169247699, 917782909, 946431337, 301550700, 840285550, 642206960, 861941157, 297917030, 206040846, 893310125, 605495371, 541889111, 773218246, 416832052, 815651714, 323649723, 684443970, 333930808, 807633312, 411016547, 703000330, 201279860, 271907827, 604494938, 1088684033, 544606238, 155658550, 498733181, 121227499, 804023681, 291364596, 886649169, 889460932, 140230450, 1039230776, 971537516, 924314105, 760674459, 940299444, 166943445, 771091877, 1018802422, 452322502, 445437483, 441919694, 480160305, 35449469, 227996121, 619258830, 1085275885, 1016800449, 362086032, 155207578, 621093561, 543817037, 512043357, 544339940, 1089208321, 2771, 848538900, 311727260, 555, 252142519, 795297487, 1011987599, 781282982, 182321384, 648602717, 320365747, 302044317, 770231109, 1016504071, 876609704, 80540399, 1046720758, 133956558, 856590508, 643619179, 962955136, 943588463, 577974908, 493307095, 61478638, 1086258876, 407420583, 1033893934, 652580721, 47307722, 933156556, 1089205551, 1089601537, 467562704, 694301057, 272794294, 522555933, 765473866, 1057743794, 239268101, 596687660, 394026248, 316852983, 567731293, 219034616, 698272581, 116570595, 913409068, 1048989199, 957176425, 141063540, 940314068, 1030417580, 186414868, 292892634, 598772864, 983386055, 226303770, 141711387, 543457013, 959678019, 568776141, 590999429, 242045678, 622628658, 1090977793, 16648, 5550, 917798269, 504708288, 27340398, 737676653, 510499597, 425645707, 417931717, 383218762, 975387910, 798197824, 600417720, 950910289, 33570752, 400800684, 615953518, 39767787, 446901234, 176094565, 1006295771, 98661281, 897865699, 29760299, 962289194, 707356832, 920306606, 773755513, 967718679, 778005350, 396217985, 1090961146, 1091043329, 8325, 728411490, 1035979731, 953394631, 572941076, 895031490, 206512907, 810801993, 315482812, 382441315, 968543490, 608756855, 366092971, 799453788, 1031078751, 934713516, 589287697, 71132321, 216596348, 456295980, 1085275977, 28210905, 1086258980, 271613722, 250826182, 362544845, 347263756, 286495361, 1089207767, 817200460, 1090972244, 1091035005, 1091174401, 993288206, 546767312, 451, 820347298, 312550944, 1030133727, 1052483276, 172880812, 807914116, 637717372, 626149908, 833565618, 92079894, 471104756, 832406564, 964814246, 12427640, 589378065, 382483395, 775197110, 21941815, 503934510, 739714417, 24986351, 457951553, 741165380, 798368014, 837852235, 568487397, 174555781, 363680416, 99196916, 1092616193, 312439391, 72907728, 972263897, 875142365, 1019033400, 583777769, 344115034, 702033824, 389534705, 365254322, 493981478, 855028075, 167118873, 240991951, 209622194, 839665272, 67265885, 997006923, 930236578, 153787907, 499091916, 543227751, 322845745, 217526907, 904560046, 205967025, 297056563, 326880184, 587449154, 57422895, 545586738, 780438947, 1093533697, 16687, 546902093, 2782, 875614503, 136823828, 938495041, 525683275, 176704622, 902392662, 1027492950, 542595371, 179579496, 354816986, 486697183, 406169849, 474640333, 409079943, 299091725, 161966330, 145480995, 657853824, 948386072, 681265983, 919698479, 203220798, 81283955, 35724368, 1063702932, 139876923, 1091173951, 1019774002, 1093517011, 1093599233, 364604177, 218788721, 1016338163, 72973265, 54746333, 45632867, 36519401, 730508454, 233143404, 136986899, 930351886, 320382686, 263502593, 281565781, 328176385, 42222099, 1001793252, 269211104, 472286465, 329816794, 207031187, 161988083, 175095429, 949108944, 311202140, 851250941, 355201685, 519544046, 272793184, 121400873, 546762677, 729060593, 1093795841, 8346, 497509126, 912153286, 644065661, 52151848, 1014412946, 365254531, 842253199, 300794457, 399224620, 507973317, 313148025, 11146440, 849525018, 1083703191, 789291628, 18254115, 724172659, 285909278, 1086914406, 951680852, 146709145, 54433994, 907673370, 495273174, 581854453, 198371136, 779409890, 218522405, 1093530916, 874876049, 1093787496, 1093926913, 364840768, 656751034, 437965095, 461125973, 701162469, 469612849, 265911332, 125157164, 799819682, 952726110, 705235551, 937406202, 375351761, 906369930, 69272829, 517607807, 129316440, 741969686, 833925684, 807957610, 788312982, 122323862, 443751333, 697344762, 666708343, 885185783, 64186403, 75352266, 218705627, 78113039, 596614396, 729282754, 1094516737, 16702, 547457761, 766622139, 205419541, 880, 1012702870, 291091410, 132104443, 261683191, 418204167, 265003088, 1076863763, 548379882, 764278870, 294685798, 855322075, 192758155, 380884448, 1046592453, 252789396, 169350665, 770415439, 774190347, 674422333, 282862777, 41967926, 509887001, 956840942, 1020691505, 182297916, 437569096, 1094500036, 1094582273, 218985332, 486745011, 73038802, 243503578, 572063081, 439937499, 579245295, 1001686867, 335787792, 248316766, 101157606, 304197320, 177187832, 656540014, 123438420, 1010656438, 668185045, 676097567, 449884946, 332334951, 788736869, 524622757, 709135288, 776674630, 918883414, 749222056, 156218305, 1038918437, 450385541, 656355035, 547255585, 875662478, 1094909953, 273797202, 109558203, 758605693, 1034222155, 158277401, 91785049, 103446596, 712273304, 467002690, 832615413, 80503579, 869658271, 275467159, 950476679, 1021104959, 353678416, 548546434, 231723613, 153955150, 323171517, 871681034, 119325436, 710043807, 286209406, 392220770, 568636855, 1048031903, 1041709530, 633325229, 328353351, 608099407, 821178288, 1095172097, 182597005, 487007156, 266034928, 195020567, 300600513, 601153403, 433075659, 720808544, 434320981, 245479661, 801859988, 218734022, 803219715, 1023925859, 436412539, 871905973, 792208796, 922789165, 78602491, 395130045, 296122306, 126497536, 456012934, 704130065, 917156756, 1057145369, 81021296, 393813021, 889293805, 1021609008, 985417287, 912640629, 1095565313, 365259547, 102885977, 1021862838, 1027272279, 1036092248, 1034388084, 711067888, 527606726, 424057722, 542637977, 169938302, 149828741, 550878885, 40255972, 701700161, 883495156, 322572893, 217841498, 973686303, 493181514, 484907915, 467645934, 728410448, 192976044, 364532572, 729196671, 625100497, 1094515858, 851340840, 336894085, 608427086, 730371303, 1095761921 };
        for(int i = 0; i < 64; i++){
            q[i] = q_t[i];
            psi[i] = psi_t[i];
            psiinv[i] = psiinv_t[i];
            q_bit[i] = q_bit_t[i];
            
        }
        for(int i = 0; i < 32;i++){
            q_hat_inv[i] = q_hat_inv_t[i];
            p_hat_inv[i] = p_hat_inv_t[i];
            Pinv[i] = Pinv_t[i];
        }
        for(int i = 0; i < 1024; i++){
            Qmod[i] = Qmod_t[i];
            Pmod[i] = Pmod_t[i];
        } 
    }
    else{
        throw "wrong polylen";
    }
}
